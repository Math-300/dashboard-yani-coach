version: '3.8'

services:
  nocodb-proxy:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: nocodb-proxy
    restart: unless-stopped
    ports:
      - "3001:3001"
    environment:
      # URL de NocoDB (no cambies esto a menos que uses otra instancia)
      - NOCODB_URL=https://app.nocodb.com

      # ⚠️ IMPORTANTE: Genera un NUEVO token en NocoDB y ponlo aquí
      # No uses el token antiguo que estaba expuesto en el código
      - NOCODB_TOKEN=TU_NUEVO_TOKEN_AQUI

      # IDs de las tablas (ya configurados con tus valores actuales)
      - TABLE_SELLERS=me6kwgo0qvg0aug
      - TABLE_CONTACTS=mrwhtwissgz1xzr
      - TABLE_INTERACTIONS=m6gx25reozjbbt3
      - TABLE_SALES=mm9p02mlk0i5ysy
      - TABLE_ATTEMPTS=mqdlglkwjvvtplc

      # Dominios permitidos (separados por coma)
      # Para desarrollo local: http://localhost:3000
      # Para producción: https://tudominio.com
      - ALLOWED_ORIGINS=http://localhost:3000,https://tudominio.com

      # Puerto del servidor
      - PORT=3001
    healthcheck:
      test: [ "CMD", "wget", "-q", "--spider", "http://localhost:3001/health" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
